#target "indesign"#targetengine "medianis"// http://extendables.org/// #include "~/_scripts/frameworks/stdbrouw-Extendables-b315665/extendables.jsx"#include "~/_scripts/frameworks/Extendables/extendables.jsx"#include "~/_scripts/lib/file.jsx"var ui = require("ui");function createWindow(fileList){    var w = new ui.Palette('A friendly welcome');    w.column('stuff')//        .text('welcome', 'hello there')        .list('archives', ['Indesign arte finalizados en la carpeta elegida'], { multiselect:true });    w.stuff.button('confirm', 'Cerrar');    w.stuff.button('colocar', 'Colocar');            w.stuff.confirm.on('click').do(function () {        this.window.close();    });    var accion_colocar = function() {        app.scriptPreferences.userInteractionLevel = UserInteractionLevels.NEVER_INTERACT;        app.scriptPreferences.enableRedraw = false;                       var sel = w.stuff.archives.window.selection;        for (var i=0; i<sel.length; ++i)        {            var ix = sel[i].index;                        var rec = app.activeWindow.activePage.rectangles.add();            app.select(rec);            app.activeDocument.place(w.fileList[ix], false);                        app.selection[0].fit(FitOptions.FRAME_TO_CONTENT);                        var name = w.fileList[ix].displayName;            sel[i].checked = true;        }        app.scriptPreferences.userInteractionLevel = UserInteractionLevels.INTERACT_WITH_ALL;        app.scriptPreferences.enableRedraw = true;    }    w.stuff.colocar.on('click').do( accion_colocar );    fileList.forEach( function(f) {            w.stuff.archives.window.add('item', f.displayName);        } );        w.fileList = fileList;    w.stuff.archives.window.properties.multiselect = true;    w.stuff.archives.window.onDoubleClick = accion_colocar;    w.window.show();}var srcFolder = Folder.selectDialog();var indds = get_files_in_path(srcFolder, "indd", true, null).filter( function(f) {    return f.name.toString().startswith('af'); } );createWindow(indds.sort());