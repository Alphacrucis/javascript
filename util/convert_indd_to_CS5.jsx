#target Indesign#strict on// Saves indesign document in CS5 version#include "~/_scripts/lib/file.jsx"const DEBUG=0;function update_format(inddFile){    try {        var doc = app.open(inddFile, false);        doc.save(inddFile);        doc.close();    } catch(e) { alert(e); }}function update_all_files_from(parentDir){    var pb = new progressBar(0, 'Actualizar documentos Indesign');    pb.show();        var files = get_files_in_path(parentDir, 'INDD', true, pb);    pb.setMaxValue(files.length);        for (var i=0, e=files.length; i<e; ++i)    {        pb.stepIt(File.decode(files[i].name));        if (DEBUG === 1) $.writeln("Updating: " + files[i].fsName);        update_format(files[i].fsName);    }    pb.stepIt('Terminado');    pb.close();}function progressBar(iter, title, parent){	var wndResource =		"""palette 		 { 			orientation:'column', 			alignChildren:'bottom', 			text: 'PROGRESO', 			mainPanel: Panel 			{ 				label1: StaticText { text: 'Progreso total', 						preferredSize:[475, 20], }, 				pgBar1: Progressbar { text: '', preferredSize:[475, 10], }, 				labelLog: StaticText { text: '', preferredSize:[475,20], }, 			}, 		 }"""	this.wnd = new Window(wndResource);	this.wnd.mainPanel.pgBar1.maxvalue = iter;		if (parent != undefined)		this.PARENT = parent;		if (title != undefined)		this.wnd.text = title;	this.stepIt = function(msg)	{		this.wnd.mainPanel.pgBar1.value++;		if (msg != undefined)			this.wnd.mainPanel.label1.text = msg;	}    this.setMessage = function(msg) { this.wnd.mainPanel.label1.text = msg; }    this.setMaxValue = function(iters) { this.wnd.mainPanel.pgBar1.maxvalue = iters; }	this.show = function() 	{ 		this.wnd.show(); 		if (this.PARENT != undefined && this.PARENT.visible)			this.wnd.frameLocation.y = this.PARENT.frameLocation.y - Math.round(this.wnd.size.height * 1.5);	}		this.close = function() { this.wnd.close(); }	this.hide = function() { this.wnd.hide(); }}function main(){    var userInteractionLevel_save = app.scriptPreferences.userInteractionLevel;    app.scriptPreferences.userInteractionLevel = UserInteractionLevels.NEVER_INTERACT;    if (!app.documents.length || !confirm('¿Actualizar documento activo?'))    {        var path = Folder.selectDialog();        if (path != null)            update_all_files_from(path);    } else if (app.documents.length)        app.activeDocument.save();    app.scriptPreferences.userInteractionLevel = userInteractionLevel_save;}main();