#target "indesign"#targetengine "medianis"// http://extendables.org/// #include "~/_scripts/frameworks/stdbrouw-Extendables-b315665/extendables.jsx"#include "~/_scripts/frameworks/Extendables/extendables.jsx"var ui = require("ui");function selectLink(name){    var links = app.activeDocument.links;    for (var i=0; i<links.length; ++i)    {        if (links[i].name == name)        {            app.select(links[i].parent);            break ;        }    }}    function searchPartial(arr, s){    for (var i=0; i<arr.length; ++i)        if (arr[i].toLowerCase().indexOf(s.toLowerCase()) >= 0)            return arr[i];    return '';}var mixins = {	'minibar': {		'size': [440, 40]    },	'mini': {		'size': [40, 20]	},    'line': {'justify':'left', 'size':[380,20] }};function createWindow(data){    var w = new ui.Palette('Seleccionar enlazados').with(mixins);    w.row('row1').using('minibar')        .input('searchFor').using('line');    w.row1.button('choose', '->').using('mini');            w.row1.choose.on('click').do(function () {        var inp = w.row1.searchFor;        if (inp.text.length > 2)        {            var res = searchPartial(links, inp.text);            if (res !== '')                selectLink(res);        }    });    var links = data;   //    w.row1.searchFor.on('changing').do( function() {//    } );        w.window.location = [0,40];    w.window.show();    w.row1.searchFor.active = true;}var linkList = [];var links = app.activeDocument.links;for (var i=0; i<links.length; ++i)    linkList.push(links[i].name);    createWindow(linkList.sort());