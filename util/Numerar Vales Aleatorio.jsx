#target indesignconst AYUDA =  """Generar PDF con números aleatorios    Busca en el documento actual un TextFrame de cotenido 0000 (exactamente así, no importa el formato de texto, solo el texto) o con etiqueta de script 'NUMERO'. Genera n pdf con un número aleatorio entre 1 y m, donde n y m son parámetros que pide el script al iniciar."""    #include "~/_scripts/frameworks/stdbrouw-Extendables-b315665/extendables.jsx"function formatInteger(digits, value)/*  Si valor, como cadena, tiene menos de `digits` digitos, añadir por la izquierda ceros */{	value = value + "";	while ( value.length < digits )		value = '0' + value;			return value;}function randomRange(min, max){    return Math.floor(Math.random() * (max - min + 1)) + min;}function export_to_pdf(PATH, i){	app.pdfExportPreferences.viewPDF = false;	    var showExportPreferences = parseInt(i) === 1;       var dest = new File(PATH + 'vale_num_' + formatInteger(3, i) + '.pdf')        app.scriptPreferences.userInteractionLevel = UserInteractionLevels.INTERACT_WITH_ALL;    app.activeDocument.exportFile(ExportFormat.pdfType, dest, showExportPreferences);	    app.scriptPreferences.userInteractionLevel = UserInteractionLevels.NEVER_INTERACT;}var do_undo = false;function main(){    if (app.documents.length == 0) { alert('¡No hay documentos abiertos!'); return ; }           var textFrame = app.activeDocument.allPageItems.filter( function(pi) {         return pi.constructor.name === "TextFrame" && (pi.label == "NUMERO" || pi.contents == '0000');    } )[0];     if (textFrame == undefined) { alert(AYUDA); return ; }        var numeroVales = prompt('Número de vales a generar', '300');    var valorMaximo = prompt('Valor máximo del intervalo de números', '1000');    var numeros = {};    Folder('~/Desktop/Vales').create();    var n;    for (var i=0; i<numeroVales; ++i)    {        n = randomRange(1, valorMaximo);        while (numeros[n] !== undefined)            n = randomRange(1, valorMaximo);                     numeros[n] = true;        textFrame.contents = formatInteger(4, n);        export_to_pdf('~/Desktop/Vales/', i+1);    }    alert('Proceso terminado');    Folder('~/Desktop/Vales').execute();        do_undo = true;}app.doScript(main,    ScriptLanguage.JAVASCRIPT   , null  , UndoModes.FAST_ENTIRE_SCRIPT  , 'Numerar');if (do_undo) app.undo();