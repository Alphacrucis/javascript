#target "Indesign-6.0"#strict on// InfoArticulo = { html:'', codigo:'', codigoCorto:'', producto:'', descripcion:'', };function infoArticulo(codigo) {}var htmlCodigoZonaIKEA = function(codigo){    const CURL = '/usr/bin/curl';    const WEB  = 'http://zona.ikeasi.com/buscar_articulo/?codigoArt=' + String(codigo);    var script = 'do shell script "' + CURL + ' ' + WEB + '"';                return app.doScript(script, ScriptLanguage.APPLESCRIPT_LANGUAGE);}function HTML(code){    this.data = cleanHtml(code);    this.html = new html_parser(this.data);        this.head;    this.body;}function cleanHtml(code){    return String(code).replace(/\s+/gm, ' ').replace(/\^$/gm, '');}function tag_parser(tk)/*  Devuelve un array de valores, donde el primer elemento es el nombre del tag    y el resto de elementos son los atributos.    */{    }function html_parser(code){    var dict = {};        var tokens = code.constructor.name === 'String' ? code.split(' ') : code;        dict.meta = '';    opened = 0; // 0 == before open, 1 == after open, before close    i = 0;    var tag = '';    var props = '';    var contents = '';    while (i<tokens.length && tokens.length)    {        var tk = tokens[i];                if (tk[0] === '<')         {            tag = tk.slice(1);            if (tag.slice(-1) == '>') tag = tag.slice(0,-1)            $.writeln(tag);        }            ++i;    }    return dict;}function tokenizer(code, sep){    """Convierte la cadena de texto suministrada como parámetro en una lista de elementos (tokens)"""        // Preformate a cadena de entrada para eliminar espacios de más, líneas vacías y otras anomalías.    code = String(code).replace(/\r|\n/gm, '').replace(/\s+/gm, ' ').replace(/\^\s*$/gm, '');    code = code[0] + code.slice(1).replace('<', ' <');        // divide la entrada por cada separador, volviéndolo a añadir a cada token//~     for (var i=0,e=sep.length; i<e; ++i)//~     {//~         if (code[0] == sep[i])//~             code = code.slice(1);//~             //~         code = code.split(sep[i]);//~         for (var j=0,ej=code.length; j<ej; ++j)//~             code[j] = sep + code[j];//~     }                return code.split(' ');}var html_test = """<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <!--<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">--> <html xmlns="http://www.w3.org/1999/xhtml"> <title>Buscador Piafacts - Desarrollo Web</title> <link href="/jqventanita/css/css_ventanita.css" rel="stylesheet" type="text/css" /> <link href="/jqventanita/css/jquery-ui-1.7.2.custom.css" rel="stylesheet" type="text/css" /> <!--<script type="text/javascript" src="/jqventanita/jq/jqventanita.js"></script> <script type="text/javascript" src="/jqventanita/jq/ventanita_uijquery.js"></script>--> <script type="text/javascript" src="/jqventanita/jqfuncioncitas.js"></script> <script type="text/javascript" src="/jqventanita/jq/jquery-1.3.2.min.js"></script> <script type="text/javascript" src="/jqventanita/jq/jquery-ui-1.7.2.custom.min.js"></script> <link href="estilo.css" rel="stylesheet" type="text/css" /> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <script type="text/javascript" src="js/jquery.js"></script> <script type="text/javascript" src="js/buscar.js"></script> </head> <body> <form id="formularioBuscar" action="" method="get" target=""> <div> Código Corto: <input name="codigoAlm" id="codigoAlm" type='text' value="" MAXLENGTH="4"/> Código Largo: <input name="codigoArt" id="codigoArt" type='text' onkeypress="return numero (event)" value="70072215" /> <br /> Nombre: <input name="nombreArt" id="nombreArt" type='text' value="" /> <input type='submit' value='Buscar'/> <input type='button' value='Administrar' onclick='javascript:administrar()'/> </div> </form> <div class="general"> <div class="reloj" id="reloj"><img src="img/cargando.gif"/></div> <div id="resAjax"></div> <div style="height: 30px;"> <b>Informe detallado </b> </div> <img class="Linea" src="img/black_11.gif" height="1" width="800" align="top"> <input type="hidden" value="70072215" name="artcod" id="artcod" /> <table border="0" cellpadding="0" width="800"> <tr> <td> <table cellpadding='4' cellspacing='0' width="800"> <tr class="fondoTrSpain"><td>Piafacts SI:</td><td><div class='alaIzq'> <span id="articulosweb.nombre">IRMA cjn 14x14" azul claro US</span> </div></td></tr> <tr class="fondoTrSpain"><td>Bitboxer SI:</td><td><div class='alaIzq'> <span id="telarticulos.descripcion">IRMA COJIN 14X14 AZUL CLARO </span> </div></td></tr> <tr class="fondoTrSpain"><td>Web SI:</td><td><div class='alaIzq'> <span id="codificacionalm.nombre_uno">IRMA</span> <span id="codificacionalm.nombre_dos">Amortiguar</span> </div></td></tr> <tr class="fondoTrSdq"><td>Piafacts SDQ:</td><td><div class='alaIzq'> <span id="articulosweb.nombre_sd"></span> </div></td></tr> <tr class="fondoTrSdq"><td>Bitboxer SDQ:</td><td><div class='alaIzq'> <span id="telarticulos.descripcion_sd">IRMA COJIN 14X14 AZUL CLARO </span> </div></td></tr> <tr class="fondoTrSdq"><td>Web SDQ:</td><td><div class='alaIzq'> <span id="codificacionalm.nombre_uno_sd">IRMA</span> <span id="codificacionalm.nombre_dos_sd">Amortiguar</span> </div></td></tr> </table> <br /> <br /> Codigo Largo:<b> 700.722.15</b> <br /> Código corto: <b>NGI</b> </td> </tr> </table> <img class="Linea" src="img/black_11.gif" height="1" width="800" align="top"> <table border="0" cellpadding="0" width="200"> <tbody> <tr> <td><b>Imagen</b></td> </tr> <tr> <td width="100">Número PE</td> <td width="100">PE120751</td> </tr> </tbody> </table> <br /> <img src="http://ibiza.ikea.es/images_articulosweb/7007221531442_PE120751_S5.jpg"><br /> <img class="Linea" src="img/black_11.gif" height="1" width="800" align="top"> <table border="0" cellpadding="0" width="800"> <tbody> <tr><td><b>Información básica</b></td></tr> </tbody> </table> <table border="0" cellpadding="0" width="800"> <tbody><tr> <td width="300">Área del producto:</td> <td width="300">1231 Cojines</td> </tr> <tr> <td width="300">Diseñador:</td> <td width="300"></td> </tr> <tr> <td width="300">Comienzo de venta:</td> <td width="300">2009-08</td> </tr> <tr> <td width="300">Necesita montaje:</td> <td width="300">No </td> </tr> <tr> <td width="300">Advice and Instruction:</td> <td width="300"></td> </tr> <tr> <td width="300">Bulto(s)/artículo:</td> <td width="300">1</td> </tr> <tr> <td width="300">Grupo de estilos:</td> <td width="300">IKEA Basic Modern</td> </tr> </tbody></table><br> <img class="Linea" src="img/black_11.gif" height="1" width="800" align="top"> <table border="0" cellpadding="0" width="800"> <tbody><tr valign="top"> <td> <b>Materiales<br></b> <!-- Código con el que falla: 00045560 --> <table border="0" cellpadding="0" width="800"> <tbody><tr valign="top"> <td width="300">Tela:<br />50% algodón, 50% poliéster<br />Relleno:<br />Fibras de poliéster<br /></td></tr></tbody></table><br> </td> </tr> </tbody> </table><br> <img class="Linea" src="img/black_11.gif" height="1" width="800" align="top"> <table border="0" cellpadding="0" width="800"> <tbody><tr valign="top"> <p></p><td> <b><img src="img/26i.gif" align="middle">&nbsp;&nbsp;&nbsp;¡Falta información ventajas para el cliente!</b><br> </td></tr> </table><br> <img class="Linea" src="img/black_11.gif" height="1" width="800" align="top"> <table border="0" cellpadding="0" width="800"> <tbody><tr valign="top"> <p></p> <tr valign="top"> <p></p><td> <br /> <table border="0" cellpadding="0"><tbody><tr valign="top"><td><b>Instrucciones de mantenimiento</b></br>Lavar a máquina, tibio 104°F (40°C).<br />No utilizar blanqueador.<br />Secar en secadora a temperatura baja.<br />No planchar.<br />No limpiar en seco.<br />Encoge un 4%.<br /></td></tr></table> </td></tr> </tbody> </table><br> <img class="Linea" src="img/black_11.gif" height="1" width="800" align="top"> <table border="0" cellpadding="0" width="800"> <tbody><tr valign="top"> <p></p><td> <b><img src="img/26i.gif" align="middle">&nbsp;&nbsp;&nbsp;¡Falta información medioambiental!</b><br> </td></tr> </tbody> </table><br> <img class="Linea" src="img/black_11.gif" height="1" width="800" align="top"> <table border="0" cellpadding="0" width="800"> <tbody><tr valign="top"> <p></p><td> <table border="0" cellpadding="0"><tbody><tr valign="top"><td><table border="0"> <tr> <td height="10px" colspan="1"><span></span></td> </tr><tr> <td colspan="2"><span><b>Medidas del producto</b></span></td> </tr><tr> <td></td><td align="right" width="130px" style="valign:top;"><span>Métrico</span></td><td align="right" style="valign:top;width:130px;"><span dir="ltr">Imperial</span></td> </tr><tr> <td width="135px"><span>longitud</span></td><td align="right"><span>35 cm</span></td><td align="right" style="padding-left: 20px"><span dir="ltr">14"</span></td> </tr><tr> <td width="135px"><span>ancho</span></td><td align="right"><span>35 cm</span></td><td align="right" style="padding-left: 20px"><span dir="ltr">14"</span></td> </tr> </table></td></tr></tbody></table> </td></tr> </table><br> <table border="0" cellpadding="0" width="800"> <tbody><tr valign="top"> <p></p><td> <table border="0" cellpadding="0"><tbody><tr valign="top"><td><table border="0"> <tr> <td height="10px" colspan="1"><span></span></td> </tr><tr> <td colspan="2"><span><b>Medidas del paquete</b></span></td> </tr><tr style="padding-top:10px;"> <td width="118"><table border="0"> <tr> <td><span>Cantidad</span></td> </tr><tr> <td style="padding-top:10px;"><span>Longitud</span></td> </tr><tr> <td><span>Anchura/Ancho</span></td> </tr><tr> <td><span>Altura</span></td> </tr><tr> <td><span>Diámetro</span></td> </tr><tr> <td><span>Peso neto</span></td> </tr><tr> <td><span>Peso bruto</span></td> </tr><tr> <td><span>Volumen bruto</span></td> </tr> </table></td><td width="170" style="background-color:rgb(235,235,235);"><table border="0"> <tr style="text-align:right;"> <td colspan="2" style="text-align:left;"><span>1</span></td><td style="padding-left:3px;"><span></span></td> </tr><tr style="text-align:right;"> <td width="68" style="padding-top:10px;"><span>35 cm</span></td><td width="78" style="padding-left:3px;padding-top:10px;"><span>13 ¾"</span></td> </tr><tr style="text-align:right;"> <td><span>35 cm</span></td><td style="padding-left:3px;"><span>13 ¾"</span></td> </tr><tr style="text-align:right;"> <td><span>2 cm</span></td><td style="padding-left:3px;"><span>¾"</span></td> </tr><tr style="text-align:right;"> <td><span>-</span></td><td style="padding-left:3px;"><span>-</span></td> </tr><tr style="text-align:right;"> <td><span>0.2 kg</span></td><td style="padding-left:3px;"><span>6oz</span></td> </tr><tr style="text-align:right;"> <td><span>0.2 kg</span></td><td style="padding-left:3px;"><span>6oz</span></td> </tr><tr style="text-align:right;"> <td><span>2.4 dm³</span></td><td style="padding-left:3px;"><span>-</span></td> </tr> </table></td> </tr> </table></td></tr></tbody></table> </td></tr> </table><br> </div> </body> </html>""";var html_basic = """<HTML><HEAD><TITLE>html m&iacute;nimo</TITLE></HEAD><BODY charset="utf-8"><h1>Titular de la pagina</h1><p>Este es el texto que <b>aparece</b> en la pagina</p></body></html>"""tokens = tokenizer( html_basic, "<" ); for (var i=0; i<tokens.length; ++i)    $.writeln(tokens[i]);