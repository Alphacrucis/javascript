/* Divide el textframe en varios textframes, partiendo por un marcador dentro del texto a elegir */ #target "indesign"#strict on// http://extendables.org/#include "~/_scripts/frameworks/Extendables/extendables.jsx"#include "~/_scripts/lib/generic.jsx"function splitIt(){    var sepBy = prompt('Separador para dividir el textframe', '<>');    if (sepBy != null)        return function(textFrame) { splitTextFrame(textFrame, sepBy); };    else return function() {};}function splitTextFrame(textFrame, sepBy){    var contents = textFrame.contents.toString();    var len = contents.length;    var count = contents.split(sepBy).length;    finalTextFrames = [textFrame];    repeat_(count-1, function(i) {         finalTextFrames.push(textFrame.duplicate(app.activeWindow.activePage, [50*(i+1), 0]));    });    ranges = [contents.indexOf(sepBy)];    repeat_(count-2, function(i) {         ranges.push( contents.indexOf(sepBy, ranges.last()+1) );    });    var remove_chars = function(i, begin, end) {         finalTextFrames[i].characters.itemByRange(begin, end).remove();     }    repeat_(count, function(i) {        if (i<count-1)            remove_chars(i, ranges[i], contents.length-1);        if (i>0)            remove_chars(i, 0, ranges[i-1]+sepBy.length-1);    });}function main(){    app.scriptPreferences.userInteractionLevel = UserInteractionLevels.NEVER_INTERACT;    app.scriptPreferences.enableRedraw = false;           try     {        app.selection.map( splitIt() );            } finally     {        app.scriptPreferences.userInteractionLevel = UserInteractionLevels.INTERACT_WITH_ALL;        app.scriptPreferences.enableRedraw = true;    }}app.doScript(main,    ScriptLanguage.JAVASCRIPT   , null  , UndoModes.ENTIRE_SCRIPT  , '');