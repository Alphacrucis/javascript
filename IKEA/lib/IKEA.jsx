var IKEA = new (function CIKEA_CONST() {    this.ALMSTYLE = 'AlmCOD';    this.reRD = /RD\$/m;    this.rePR = /US\$/m;    this.PRICE = { RD:/\bRD\$(\d+,)?\d+/gm, GENERIC:/(\d+,)?\d+\b/gm };     // RD$#,###    this.reCODE = /\d{3}\.\d{3}\.\d{2}/gm;    this.PRICESYMBOL = { RD:"RD$", SI:"€", PR:"US$" };    this.CACHEDCODES = '~/codigos_alm.csv';        this.extractIKEACode = function(contents) { return contents.toString().replace(/\./g,'').replace(/[^\d]/,''); }    this.formatIKEACode = function(code) {         return "%1.%2.%3".replace("%1", code.slice(0, 3))                         .replace("%2", code.slice(3, 6))                         .replace("%1", code.slice(6, 9));    }    this.removeLabelMarks = function(tFrame)    {        var charCode = String.fromCharCode(65279);        if (tFrame.contents.toString().indexOf(charCode) >= 0) {            //tFrame.contents = tFrame.contents.toString().replace(RegExp(charCode, 'gm'), '');            tFrame.characters.everyItem().getElements().forEach( function(c) {                if (c.contents.toString() === charCode)                    c.contents = '';            } );            $.writeln('Etiqueta XML eliminada');        }    }        this.extractDescription = function(tFrame) {        var descrip = [];        var item = [];        tFrame.words.everyItem().getElements()                                .forEach( function(w) {                                     if (w.appliedFont.fontStyleName == 'Bold')                                        item.push(w.contents);                                    if (/\$|\€/m.test(w.contents)) {                                        descrip.push(item.join(' '));                                        item = [];                                    }                                });        return descrip;    }    //~         this.extractDescription = function(tFrame) {//~             """DÅTID campana extractora RD$34,500 Tres velocidades. Incluye 2 filtros de grasa y 2 bombillos halógenos. 264W de potencia. Negro. 30x20” 002.222.18"""//~             var isBold = false;//~             var description = [];//~             for (var i=0, e=tFrame.words.length; i<e; ++i) {//~                 w = tFrame.words;//~                 if (w.appliedFont.fontStyleName == 'Bold') {//~                     isBold = true;//~                     description.push(w.contents);//~                 } else if (isBold) { break ; }//~             }//~         }})();//~ var extractDescription = function(tFrame, sliceBy) {//~     var isBold = false;//~     var description = [];//~     var ignore = 0;//~     for (var i=0, e=tFrame.words.length; i<e; ++i) {//~         w = tFrame.words[i];//~         if (w.appliedFont.fontStyleName == 'Bold' && ! /(\d+,)?\d+\b/gm.test(w.contents) ) {//~             isBold = true;//~             if (ignore == sliceBy)//~                 description.push(w.contents);//~         } else if (isBold) { //~             ignore++;//~             if (ignore > sliceBy) break ; //~         }//~     }//~     return description.join(' ');//~ }//~ alert(extractDescription(app.activeDocument.selection[0], 1));